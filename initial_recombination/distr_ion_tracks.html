<!DOCTYPE html>
<!-- Generated by Cython 0.23.4 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: distr_ion_tracks.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.23.4</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="distr_ion_tracks.c">distr_ion_tracks.c</a></p>
<div class="cython"><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">001</span>: import cython</pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: # Declarations exclusively to either pure Python or Cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: # Lines in triple quotes will be executed in .pyx files</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: # Get full access to all of Cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: cimport cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: # Seperate but equivalent imports and</pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: # definitions in pure Python and Cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: # Lines in triple quotes will be executed in .pyx files.</pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: # Mathematical constants and functions</pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: from libc.math cimport (M_PI as pi, sin, cos, tan, asin as arcsin, acos as arccos, atan as arctan, sinh, cosh, tanh, asinh as arcsinh, acosh as arccosh, atanh as arctanh, exp, log, log2, log10, sqrt, erfc )</pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: </pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">015</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick='toggleDiv(this)'>+<span class="">016</span>: import matplotlib.pyplot as plt</pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__32);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s__32);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_plt, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick='toggleDiv(this)'>+<span class="">017</span>: from copy import deepcopy</pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_deepcopy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_deepcopy);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_deepcopy);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_copy, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_deepcopy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_deepcopy, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick='toggleDiv(this)'>+<span class="">018</span>: import matplotlib.gridspec as gridspec</pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__32);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s__32);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_matplotlib_gridspec, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gridspec, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">019</span>: import pylab as pl</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pylab, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pl, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">020</span>: import math</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_math, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_math, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 20; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: @cython.ccall</pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: @cython.locals( # variables</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:                 track_radii='double[::1]',</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>:                 track_LETs='double[::1]',</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>:                 parameter_list='list',</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>:                 SHOW_PLOT='bint',</pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>:                 #locals</pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:                 )</pre>
<pre class="cython line score-67" onclick='toggleDiv(this)'>+<span class="">031</span>: def distribute_and_evolve(track_radii,track_LETs,parameter_list,SHOW_PLOT):</pre>
<pre class='cython code score-67 '>static PyObject *__pyx_pw_16distr_ion_tracks_1distribute_and_evolve(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_16distr_ion_tracks_distribute_and_evolve(__Pyx_memviewslice __pyx_v_track_radii, __Pyx_memviewslice __pyx_v_track_LETs, PyObject *__pyx_v_parameter_list, int __pyx_v_SHOW_PLOT, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("distribute_and_evolve", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("distr_ion_tracks.distribute_and_evolve", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_16distr_ion_tracks_1distribute_and_evolve(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_16distr_ion_tracks_1distribute_and_evolve(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_track_radii = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_track_LETs = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_parameter_list = 0;
  int __pyx_v_SHOW_PLOT;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("distribute_and_evolve (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_track_radii,&amp;__pyx_n_s_track_LETs,&amp;__pyx_n_s_parameter_list,&amp;__pyx_n_s_SHOW_PLOT,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_track_radii)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_track_LETs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("distribute_and_evolve", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_parameter_list)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("distribute_and_evolve", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_SHOW_PLOT)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("distribute_and_evolve", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "distribute_and_evolve") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_track_radii = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_track_radii.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_track_LETs = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_track_LETs.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_parameter_list = ((PyObject*)values[2]);
    __pyx_v_SHOW_PLOT = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_SHOW_PLOT == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("distribute_and_evolve", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("distr_ion_tracks.distribute_and_evolve", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_parameter_list), (&amp;PyList_Type), 1, "parameter_list", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_16distr_ion_tracks_distribute_and_evolve(__pyx_self, __pyx_v_track_radii, __pyx_v_track_LETs, __pyx_v_parameter_list, __pyx_v_SHOW_PLOT);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_16distr_ion_tracks_distribute_and_evolve(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_track_radii, __Pyx_memviewslice __pyx_v_track_LETs, PyObject *__pyx_v_parameter_list, int __pyx_v_SHOW_PLOT) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("distribute_and_evolve", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_track_radii.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("track_radii"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  if (unlikely(!__pyx_v_track_LETs.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("track_LETs"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_1 = __pyx_f_16distr_ion_tracks_distribute_and_evolve(__pyx_v_track_radii, __pyx_v_track_LETs, __pyx_v_parameter_list, __pyx_v_SHOW_PLOT, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 31; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("distr_ion_tracks.distribute_and_evolve", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_track_radii, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_track_LETs, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick='toggleDiv(this)'>+<span class="">032</span>:     return f(track_radii,track_LETs,parameter_list,SHOW_PLOT)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_16distr_ion_tracks_f(__pyx_v_track_radii, __pyx_v_track_LETs, __pyx_v_parameter_list, __pyx_v_SHOW_PLOT);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: @cython.cfunc</pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: @cython.cdivision(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: @cython.initializedcheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: @cython.locals( # variables</pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>:                 track_radii='double[::1]',</pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>:                 track_LETs='double[::1]',</pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>:                 parameter_list='list',</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:                 SHOW_PLOT='bint',</pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>:                 # arrays</pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>:                 positive_array='double[:,:,::1]', negative_array='double[:,:,::1]',positive_array_temp='double[:,:,::1]',</pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>:                 negative_array_temp='double[:,:,::1]',positive_array_slice='double[:,::1]',</pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>:                 # load variables</pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>:                 ion_diff='double',ion_mobility='double',Efield='double',dx='double',dy='double',dz='double',W='double',</pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>:                 no_z_electrode='int', d='double',theta='double',alpha='double',dt='double',</pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>:                 no_x='size_t',no_y='size_t',no_z='size_t',no_z_with_buffer='size_t',</pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:                 # indices and lengths</pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>:                 nx='size_t',ny='size_t',nz='size_t',i='size_t',j='size_t',k='size_t',</pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>:                 mid_x_array='size_t',mid_y_array='size_t',mid_z_array='size_t',N0='double',b='double',front_factor='double',distance_from_center='double',</pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>:                 # von Neumann analysis</pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>:                 sx='double', sy='double', sz='double', cx='double', cy='double', cz='double',von_neumann_expression='bint',</pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>:                 # Lax-Wendroff scheme</pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>:                 positive_temp_entry='double',negative_temp_entry='double',</pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>:                 recomb_temp='double',no_recombined_charge_carriers='double',</pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>:                 update_figure_step='size_t',</pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>:                 no_initialised_charge_carriers='double',ion_density='double',computation_time_steps='int',time_step='int',no_figure_updates='size_t',</pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>:                 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: </pre>
<pre class="cython line score-16" onclick='toggleDiv(this)'>+<span class="">065</span>: def f(track_radii,track_LETs,parameter_list,SHOW_PLOT):</pre>
<pre class='cython code score-16 '>static PyObject *__pyx_f_16distr_ion_tracks_f(__Pyx_memviewslice __pyx_v_track_radii, __Pyx_memviewslice __pyx_v_track_LETs, PyObject *__pyx_v_parameter_list, int __pyx_v_SHOW_PLOT) {
  double __pyx_v_N0;
  size_t __pyx_v_mid_x_array;
  double __pyx_v_W;
  size_t __pyx_v_k;
  double __pyx_v_dz;
  double __pyx_v_dy;
  double __pyx_v_distance_from_center;
  double __pyx_v_theta;
  double __pyx_v_recomb_temp;
  __Pyx_memviewslice __pyx_v_positive_array_temp = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_alpha;
  int __pyx_v_time_step;
  double __pyx_v_positive_temp_entry;
  __Pyx_memviewslice __pyx_v_negative_array_temp = { 0, 0, { 0 }, { 0 }, { 0 } };
  size_t __pyx_v_mid_y_array;
  size_t __pyx_v_mid_z_array;
  double __pyx_v_dt;
  size_t __pyx_v_no_z;
  double __pyx_v_no_initialised_charge_carriers;
  double __pyx_v_cy;
  size_t __pyx_v_no_y;
  __Pyx_memviewslice __pyx_v_negative_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_sy;
  double __pyx_v_cz;
  double __pyx_v_sx;
  size_t __pyx_v_no_x;
  double __pyx_v_b;
  double __pyx_v_no_recombined_charge_carriers;
  size_t __pyx_v_j;
  __Pyx_memviewslice __pyx_v_positive_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_ion_mobility;
  double __pyx_v_ion_density;
  int __pyx_v_computation_time_steps;
  double __pyx_v_ion_diff;
  double __pyx_v_front_factor;
  double __pyx_v_cx;
  size_t __pyx_v_no_z_with_buffer;
  int __pyx_v_no_z_electrode;
  size_t __pyx_v_update_figure_step;
  double __pyx_v_negative_temp_entry;
  double __pyx_v_sz;
  double __pyx_v_Efield;
  double __pyx_v_d;
  size_t __pyx_v_i;
  int __pyx_v_von_neumann_expression;
  size_t __pyx_v_no_figure_updates;
  double __pyx_v_dx;
  double __pyx_v_MINVAL;
  double __pyx_v_MAXVAL;
  PyObject *__pyx_v_fig = NULL;
  PyObject *__pyx_v_ax1 = NULL;
  PyObject *__pyx_v_ax2 = NULL;
  PyObject *__pyx_v_ax3 = NULL;
  PyObject *__pyx_v_figure3 = NULL;
  PyObject *__pyx_v_cbar_ax1 = NULL;
  PyObject *__pyx_v_cb = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("f", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_25, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("distr_ion_tracks.f", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_positive_array_temp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_negative_array_temp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_negative_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_positive_array, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ax1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ax2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ax3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_figure3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cbar_ax1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cb);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:     #initialize the simulation parameters:</pre>
<pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">068</span>:     ion_diff    = parameter_list[0] # [UNITS] ion diffusivity</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 0));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_ion_diff = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">069</span>:     ion_mobility= parameter_list[1] # [UNITS] ion mobility</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 1));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_ion_mobility = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">070</span>:     Efield      = parameter_list[2] # [V/cm] magnitude of the electric field</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 2));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_Efield = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">071</span>:     dx          = parameter_list[3] # [cm] distance between two neighbouring voxels (x-direction)</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 3));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_dx = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">072</span>:     dy          = parameter_list[4] # [cm] distance between two neighbouring voxels (y-direction)</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 4));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_dy = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">073</span>:     dz          = parameter_list[5] # [cm] distance between two neighbouring voxels (z-direction)</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 5));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_dz = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">074</span>:     theta       = parameter_list[6] # [rad] angle between electric field and the ion track(s)</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 6));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_theta = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">075</span>:     alpha       = parameter_list[7] # [cm^3/s] recombination constant</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 7));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_alpha = __pyx_t_1;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">076</span>:     no_x        = parameter_list[8] # number of elements in the x-direction</pre>
<pre class='cython code score-8 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 8));<span class='error_goto'> if (unlikely((__pyx_t_2 == (size_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_no_x = __pyx_t_2;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">077</span>:     no_y        = parameter_list[9]# number of elements in the y-direction</pre>
<pre class='cython code score-8 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 9));<span class='error_goto'> if (unlikely((__pyx_t_2 == (size_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_no_y = __pyx_t_2;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">078</span>:     no_z        = parameter_list[10]# number of elements in the z-direction</pre>
<pre class='cython code score-8 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 10));<span class='error_goto'> if (unlikely((__pyx_t_2 == (size_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 78; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_no_z = __pyx_t_2;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">079</span>:     no_z_electrode   = parameter_list[11] # remove?</pre>
<pre class='cython code score-8 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 11));<span class='error_goto'> if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_no_z_electrode = __pyx_t_3;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">080</span>:     d           = parameter_list[12] # [cm] # electrode gap</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 12));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_d = __pyx_t_1;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">081</span>:     W           = parameter_list[13] # [UNITS] energy required to form a pair of ions</pre>
<pre class='cython code score-11 '>  if (unlikely(__pyx_v_parameter_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parameter_list, 13));<span class='error_goto'> if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_W = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>:     # total length, i.e. electrode gap plus the two electrode buffers</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">084</span>:     no_z_with_buffer = 2*no_z_electrode + no_z</pre>
<pre class='cython code score-0 '>  __pyx_v_no_z_with_buffer = ((2 * __pyx_v_no_z_electrode) + __pyx_v_no_z);
</pre><pre class="cython line score-0">&#xA0;<span class="">085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>:     # number of times the figure is updated</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">087</span>:     no_figure_updates = 5</pre>
<pre class='cython code score-0 '>  __pyx_v_no_figure_updates = 5;
</pre><pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:     # preallocate arrays</pre>
<pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">090</span>:     positive_array=np.zeros((no_x,no_y,no_z+2*no_z_electrode))</pre>
<pre class='cython code score-46 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_v_no_x);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_v_no_y);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>((__pyx_v_no_z + (2 * __pyx_v_no_z_electrode)));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_8);
  __pyx_t_5 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 90; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_positive_array = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">091</span>:     positive_array_temp=np.zeros((no_x,no_y,no_z+2*no_z_electrode))</pre>
<pre class='cython code score-46 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_v_no_x);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_v_no_y);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>((__pyx_v_no_z + (2 * __pyx_v_no_z_electrode)));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_8);
  __pyx_t_6 = 0;
  __pyx_t_9 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_positive_array_temp = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">092</span>:     negative_array_temp = np.zeros((no_x, no_y, no_z + 2 * no_z_electrode))</pre>
<pre class='cython code score-46 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_v_no_x);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_v_no_y);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>((__pyx_v_no_z + (2 * __pyx_v_no_z_electrode)));<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_8);
  __pyx_t_7 = 0;
  __pyx_t_5 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_8); __pyx_t_8 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_negative_array_temp = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">093</span>:     no_recombined_charge_carriers = 0.</pre>
<pre class='cython code score-0 '>  __pyx_v_no_recombined_charge_carriers = 0.;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">094</span>:     no_initialised_charge_carriers = 0.</pre>
<pre class='cython code score-0 '>  __pyx_v_no_initialised_charge_carriers = 0.;
</pre><pre class="cython line score-0">&#xA0;<span class="">095</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:     # find the middle of the arrays (mainly for the Gaussian distribution and updating the figures)</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">097</span>:     mid_x_array=int(no_x/2.)</pre>
<pre class='cython code score-0 '>  __pyx_v_mid_x_array = ((size_t)(((double)__pyx_v_no_x) / 2.));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">098</span>:     mid_y_array=mid_x_array</pre>
<pre class='cython code score-0 '>  __pyx_v_mid_y_array = __pyx_v_mid_x_array;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">099</span>:     mid_z_array=int(no_z/2.)</pre>
<pre class='cython code score-0 '>  __pyx_v_mid_z_array = ((size_t)(((double)__pyx_v_no_z) / 2.));
</pre><pre class="cython line score-0">&#xA0;<span class="">100</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:     # ensure the resolution is the same in all directions for the the approximations below</pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">102</span>:     assert(dx==dy and dy==dz)</pre>
<pre class='cython code score-5 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_12 = ((__pyx_v_dx == __pyx_v_dy) != 0);
    if (__pyx_t_12) {
    } else {
      __pyx_t_11 = __pyx_t_12;
      goto __pyx_L3_bool_binop_done;
    }
    __pyx_t_12 = ((__pyx_v_dy == __pyx_v_dz) != 0);
    __pyx_t_11 = __pyx_t_12;
    __pyx_L3_bool_binop_done:;
    if (unlikely(!__pyx_t_11)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">103</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>:     #initialize a Gaussian track carrier distribution around a track in the center of the array</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">105</span>:     N0 = track_LETs[0]/W # Linear charge carrier density</pre>
<pre class='cython code score-0 '>  __pyx_t_13 = 0;
  __pyx_v_N0 = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_track_LETs.data) + __pyx_t_13)) ))) / __pyx_v_W);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">106</span>:     b = track_radii[0] # Gaussian track radius</pre>
<pre class='cython code score-0 '>  __pyx_t_14 = 0;
  __pyx_v_b = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_track_radii.data) + __pyx_t_14)) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">107</span>:     front_factor = N0/(pi*(b*b))</pre>
<pre class='cython code score-0 '>  __pyx_v_front_factor = (__pyx_v_N0 / (M_PI * (__pyx_v_b * __pyx_v_b)));
</pre><pre class="cython line score-0">&#xA0;<span class="">108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>:     # do not initialize charge carriers in the electrodes arrays</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">110</span>:     for k in range(no_z_electrode,no_z+no_z_electrode):</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_no_z + __pyx_v_no_z_electrode);
  for (__pyx_t_15 = __pyx_v_no_z_electrode; __pyx_t_15 &lt; __pyx_t_2; __pyx_t_15+=1) {
    __pyx_v_k = __pyx_t_15;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">111</span>:         for i in range(no_x):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_no_x;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">112</span>:             for j in range(no_y):</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_no_y;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_j = __pyx_t_19;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">113</span>:                 distance_from_center=sqrt(((i-mid_x_array)  *(i-mid_x_array)  )+ ((j-mid_y_array) *(j-mid_y_array) ))*dx</pre>
<pre class='cython code score-0 '>        __pyx_v_distance_from_center = (sqrt((((__pyx_v_i - __pyx_v_mid_x_array) * (__pyx_v_i - __pyx_v_mid_x_array)) + ((__pyx_v_j - __pyx_v_mid_y_array) * (__pyx_v_j - __pyx_v_mid_y_array)))) * __pyx_v_dx);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">114</span>:                 ion_density=front_factor*exp(-(distance_from_center*distance_from_center)/(b*b))</pre>
<pre class='cython code score-0 '>        __pyx_v_ion_density = (__pyx_v_front_factor * exp(((-(__pyx_v_distance_from_center * __pyx_v_distance_from_center)) / (__pyx_v_b * __pyx_v_b))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">115</span>:                 positive_array[i,j,k]=ion_density</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_i;
        __pyx_t_21 = __pyx_v_j;
        __pyx_t_22 = __pyx_v_k;
        *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_20 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_21 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_22)) )) = __pyx_v_ion_density;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">116</span>:                 no_initialised_charge_carriers+=ion_density</pre>
<pre class='cython code score-0 '>        __pyx_v_no_initialised_charge_carriers = (__pyx_v_no_initialised_charge_carriers + __pyx_v_ion_density);
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">117</span>: </pre>
<pre class="cython line score-55" onclick='toggleDiv(this)'>+<span class="">118</span>:     negative_array=deepcopy(np.asarray(positive_array,dtype='double'))</pre>
<pre class='cython code score-55 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_deepcopy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_positive_array, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_n_u_double) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_8, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_negative_array = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">119</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>:     # for the colorbars</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">121</span>:     MINVAL = 0.</pre>
<pre class='cython code score-0 '>  __pyx_v_MINVAL = 0.;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">122</span>:     MAXVAL = front_factor</pre>
<pre class='cython code score-0 '>  __pyx_v_MAXVAL = __pyx_v_front_factor;
</pre><pre class="cython line score-0">&#xA0;<span class="">123</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">124</span>:     if SHOW_PLOT:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_SHOW_PLOT != 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">125</span>:         plt.close('all')</pre>
<pre class='cython code score-14 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_close);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_all);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">126</span>:         fig = plt.figure()</pre>
<pre class='cython code score-21 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_figure);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    if (__pyx_t_9) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    } else {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_v_fig = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-22" onclick='toggleDiv(this)'>+<span class="">127</span>:         plt.ion()</pre>
<pre class='cython code score-22 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ion);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    if (__pyx_t_8) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    } else {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">128</span>:         gridspec.GridSpec(1, 3, width_ratios=[1, 1, 1])</pre>
<pre class='cython code score-37 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_gridspec);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_GridSpec);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 2, __pyx_int_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_width_ratios, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-0">&#xA0;<span class="">129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>:         # define locations of subfigures in the grid</pre>
<pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">131</span>:         ax1 = plt.subplot2grid((5,3),(0,0),rowspan=4)</pre>
<pre class='cython code score-34 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_subplot2grid);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_5, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
    __pyx_t_8 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_rowspan, __pyx_int_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__5, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_v_ax1 = __pyx_t_9;
    __pyx_t_9 = 0;
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__3, __pyx_tuple__4);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">132</span>:         ax2 = plt.subplot2grid((5,3),(0,1),rowspan=4)</pre>
<pre class='cython code score-34 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_subplot2grid);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_5, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
    __pyx_t_9 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_rowspan, __pyx_int_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_tuple__8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_v_ax2 = __pyx_t_4;
    __pyx_t_4 = 0;
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__6, __pyx_tuple__7);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">133</span>:         ax3 = plt.subplot2grid((5,3),(0,2),rowspan=4)</pre>
<pre class='cython code score-34 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_subplot2grid);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_5, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_rowspan, __pyx_int_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__11, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_ax3 = __pyx_t_8;
    __pyx_t_8 = 0;
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__9, __pyx_tuple__10);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-0">&#xA0;<span class="">134</span>: </pre>
<pre class="cython line score-94" onclick='toggleDiv(this)'>+<span class="">135</span>:         ax1.imshow(np.asarray(positive_array[mid_x_array,:,:]).transpose(), vmin=MINVAL, vmax=MAXVAL)</pre>
<pre class='cython code score-94 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax1, __pyx_n_s_imshow);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_23.data = __pyx_v_positive_array.data;
    __pyx_t_23.memview = __pyx_v_positive_array.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_mid_x_array;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_positive_array.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_positive_array.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_23.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_23.shape[0] = __pyx_v_positive_array.shape[1];
__pyx_t_23.strides[0] = __pyx_v_positive_array.strides[1];
    __pyx_t_23.suboffsets[0] = -1;

__pyx_t_23.shape[1] = __pyx_v_positive_array.shape[2];
__pyx_t_23.strides[1] = __pyx_v_positive_array.strides[2];
    __pyx_t_23.suboffsets[1] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_23, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    } else {
      __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_6); __pyx_t_6 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0+1, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_transpose);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (__pyx_t_9) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    } else {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_vmin, __pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_vmax, __pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">136</span>:         ax2.imshow(positive_array[:,:,mid_y_array], vmin=MINVAL, vmax=MAXVAL)</pre>
<pre class='cython code score-46 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax2, __pyx_n_s_imshow);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_25.data = __pyx_v_positive_array.data;
    __pyx_t_25.memview = __pyx_v_positive_array.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_25, 0);
    __pyx_t_25.shape[0] = __pyx_v_positive_array.shape[0];
__pyx_t_25.strides[0] = __pyx_v_positive_array.strides[0];
    __pyx_t_25.suboffsets[0] = -1;

__pyx_t_25.shape[1] = __pyx_v_positive_array.shape[1];
__pyx_t_25.strides[1] = __pyx_v_positive_array.strides[1];
    __pyx_t_25.suboffsets[1] = -1;

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_mid_y_array;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_positive_array.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_positive_array.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_25.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_25, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_25, 1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_vmin, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_vmax, __pyx_t_8) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">137</span>:         figure3 = ax3.imshow(positive_array[:,:,mid_x_array], vmin=MINVAL, vmax=MAXVAL)</pre>
<pre class='cython code score-45 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax3, __pyx_n_s_imshow);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_25.data = __pyx_v_positive_array.data;
    __pyx_t_25.memview = __pyx_v_positive_array.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_25, 0);
    __pyx_t_25.shape[0] = __pyx_v_positive_array.shape[0];
__pyx_t_25.strides[0] = __pyx_v_positive_array.strides[0];
    __pyx_t_25.suboffsets[0] = -1;

__pyx_t_25.shape[1] = __pyx_v_positive_array.shape[1];
__pyx_t_25.strides[1] = __pyx_v_positive_array.strides[1];
    __pyx_t_25.suboffsets[1] = -1;

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_mid_x_array;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_positive_array.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_positive_array.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_25.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_25, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_25, 1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_vmin, __pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_vmax, __pyx_t_9) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_figure3 = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>:         # adjust the 3 subfigures</pre>
<pre class="cython line score-22" onclick='toggleDiv(this)'>+<span class="">140</span>:         ax1.set_aspect('equal'); ax1.axis('off')</pre>
<pre class='cython code score-22 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax1, __pyx_n_s_set_aspect);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax1, __pyx_n_s_axis);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_equal);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_off);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-22" onclick='toggleDiv(this)'>+<span class="">141</span>:         ax2.set_aspect('equal'); ax2.axis('off')</pre>
<pre class='cython code score-22 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax2, __pyx_n_s_set_aspect);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax2, __pyx_n_s_axis);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_equal);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_off);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
</pre><pre class="cython line score-22" onclick='toggleDiv(this)'>+<span class="">142</span>:         ax3.set_aspect('equal'); ax3.axis('off')</pre>
<pre class='cython code score-22 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax3, __pyx_n_s_set_aspect);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax3, __pyx_n_s_axis);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_equal);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_off);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-0">&#xA0;<span class="">143</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>:         # fix colorbar</pre>
<pre class="cython line score-39" onclick='toggleDiv(this)'>+<span class="">145</span>:         cbar_ax1 = fig.add_axes([0.1, 0.1, 0.8, 0.03])</pre>
<pre class='cython code score-39 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fig, __pyx_n_s_add_axes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_float_0_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_float_0_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_8);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_float_0_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_03);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_03);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, __pyx_float_0_03);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    } else {
      __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_8); __pyx_t_8 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0+1, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_cbar_ax1 = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">146</span>:         cb = fig.colorbar(figure3, cax=cbar_ax1, orientation='horizontal', label="Charge carrier density [per cm^3]")</pre>
<pre class='cython code score-34 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fig, __pyx_n_s_colorbar);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_figure3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_figure3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_figure3);
    __pyx_t_24 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_cax, __pyx_v_cbar_ax1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_orientation, __pyx_n_u_horizontal) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_label, __pyx_kp_u_Charge_carrier_density_per_cm_3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_4, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    __pyx_v_cb = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">147</span>:         cb.set_clim(vmin=MINVAL, vmax=MAXVAL)</pre>
<pre class='cython code score-34 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_cb, __pyx_n_s_set_clim);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_24 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmin, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmax, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">148</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>:     # include space charge screenings of the electric field</pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>:     # if space_charge_screening_effects &gt; 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">153</span>:     # find a time step dt which fulfils the von Neumann criterion, i.e. ensures the numericl error does not increase but</pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>:     # decreases and eventually damps out</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">155</span>:     dt = 1.</pre>
<pre class='cython code score-0 '>  __pyx_v_dt = 1.;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">156</span>:     von_neumann_expression = False</pre>
<pre class='cython code score-0 '>  __pyx_v_von_neumann_expression = 0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">157</span>:     while not von_neumann_expression:</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_11 = ((!(__pyx_v_von_neumann_expression != 0)) != 0);
    if (!__pyx_t_11) break;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">158</span>:         dt /= 1.01</pre>
<pre class='cython code score-0 '>    __pyx_v_dt = (__pyx_v_dt / 1.01);
</pre><pre class="cython line score-0">&#xA0;<span class="">159</span>:         # as defined in the Deghan (2004) paper</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">160</span>:         sx = ion_diff*dt/((dx*dx))</pre>
<pre class='cython code score-0 '>    __pyx_v_sx = ((__pyx_v_ion_diff * __pyx_v_dt) / (__pyx_v_dx * __pyx_v_dx));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">161</span>:         sy = ion_diff*dt/((dy*dy))</pre>
<pre class='cython code score-0 '>    __pyx_v_sy = ((__pyx_v_ion_diff * __pyx_v_dt) / (__pyx_v_dy * __pyx_v_dy));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">162</span>:         sz = ion_diff*dt/((dz*dz))</pre>
<pre class='cython code score-0 '>    __pyx_v_sz = ((__pyx_v_ion_diff * __pyx_v_dt) / (__pyx_v_dz * __pyx_v_dz));
</pre><pre class="cython line score-0">&#xA0;<span class="">163</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">164</span>:         cx = ion_mobility*Efield*dt/dx*sin(theta)</pre>
<pre class='cython code score-0 '>    __pyx_v_cx = ((((__pyx_v_ion_mobility * __pyx_v_Efield) * __pyx_v_dt) / __pyx_v_dx) * sin(__pyx_v_theta));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">165</span>:         cy = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_cy = 0.0;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">166</span>:         cz = ion_mobility*Efield*dt/dz*cos(theta)</pre>
<pre class='cython code score-0 '>    __pyx_v_cz = ((((__pyx_v_ion_mobility * __pyx_v_Efield) * __pyx_v_dt) / __pyx_v_dz) * cos(__pyx_v_theta));
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:         # check von Neumann's criterion</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">169</span>:         von_neumann_expression = (2*(sx + sy + sz) + (cx*cx)+ (cy*cy)+ (cz*cz)&lt;= 1 and (cx*cx)*(cy*cy)*(cz*cz)&lt;= 8*sx*sy*sz)</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = ((((((2.0 * ((__pyx_v_sx + __pyx_v_sy) + __pyx_v_sz)) + (__pyx_v_cx * __pyx_v_cx)) + (__pyx_v_cy * __pyx_v_cy)) + (__pyx_v_cz * __pyx_v_cz)) &lt;= 1.0) != 0);
    if (__pyx_t_12) {
    } else {
      __pyx_t_11 = __pyx_t_12;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_12 = (((((__pyx_v_cx * __pyx_v_cx) * (__pyx_v_cy * __pyx_v_cy)) * (__pyx_v_cz * __pyx_v_cz)) &lt;= (((8.0 * __pyx_v_sx) * __pyx_v_sy) * __pyx_v_sz)) != 0);
    __pyx_t_11 = __pyx_t_12;
    __pyx_L14_bool_binop_done:;
    __pyx_v_von_neumann_expression = __pyx_t_11;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>:     # calculate the number of step required to drag the two charge carrier distributions apart</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">172</span>:     computation_time_steps=int(d/(2.*ion_mobility*Efield*dt))</pre>
<pre class='cython code score-0 '>  __pyx_v_computation_time_steps = ((int)(__pyx_v_d / (((2. * __pyx_v_ion_mobility) * __pyx_v_Efield) * __pyx_v_dt)));
</pre><pre class="cython line score-0">&#xA0;<span class="">173</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>:     # one time step at a time</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">175</span>:     for time_step in range(computation_time_steps):</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_computation_time_steps;
  for (__pyx_t_26 = 0; __pyx_t_26 &lt; __pyx_t_3; __pyx_t_26+=1) {
    __pyx_v_time_step = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">176</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>:         # update the figure</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">178</span>:         if SHOW_PLOT:</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = (__pyx_v_SHOW_PLOT != 0);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">179</span>:             update_figure_step=int(computation_time_steps/no_figure_updates)</pre>
<pre class='cython code score-0 '>      __pyx_v_update_figure_step = (((size_t)__pyx_v_computation_time_steps) / __pyx_v_no_figure_updates);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">180</span>:             if time_step % update_figure_step == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (((__pyx_v_time_step % __pyx_v_update_figure_step) == 0) != 0);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-36" onclick='toggleDiv(this)'>+<span class="">181</span>:                 cb.set_clim(vmin=MINVAL, vmax=MAXVAL)</pre>
<pre class='cython code score-36 '>        if (unlikely(!__pyx_v_cb)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("cb"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_cb, __pyx_n_s_set_clim);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_24 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmin, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmax, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">182</span>: </pre>
<pre class="cython line score-99" onclick='toggleDiv(this)'>+<span class="">183</span>:                 ax1.imshow(np.asarray(negative_array[:,mid_y_array,:],dtype=np.double).transpose(),vmin=MINVAL,vmax=MAXVAL)</pre>
<pre class='cython code score-99 '>        if (unlikely(!__pyx_v_ax1)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("ax1"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax1, __pyx_n_s_imshow);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_23.data = __pyx_v_negative_array.data;
        __pyx_t_23.memview = __pyx_v_negative_array.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 0);
        __pyx_t_23.shape[0] = __pyx_v_negative_array.shape[0];
__pyx_t_23.strides[0] = __pyx_v_negative_array.strides[0];
    __pyx_t_23.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_mid_y_array;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_negative_array.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_negative_array.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_23.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_23.shape[1] = __pyx_v_negative_array.shape[2];
__pyx_t_23.strides[1] = __pyx_v_negative_array.strides[2];
    __pyx_t_23.suboffsets[1] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_23, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_transpose);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          }
        }
        if (__pyx_t_6) {
          __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        } else {
          __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_24);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_24);
        __pyx_t_24 = 0;
        __pyx_t_24 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmin, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmax, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-99" onclick='toggleDiv(this)'>+<span class="">184</span>:                 ax2.imshow(np.asarray(positive_array[:,mid_y_array,:],dtype=np.double).transpose(),vmin=MINVAL,vmax=MAXVAL)</pre>
<pre class='cython code score-99 '>        if (unlikely(!__pyx_v_ax2)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("ax2"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax2, __pyx_n_s_imshow);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_23.data = __pyx_v_positive_array.data;
        __pyx_t_23.memview = __pyx_v_positive_array.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 0);
        __pyx_t_23.shape[0] = __pyx_v_positive_array.shape[0];
__pyx_t_23.strides[0] = __pyx_v_positive_array.strides[0];
    __pyx_t_23.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_mid_y_array;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_positive_array.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_positive_array.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_23.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_23.shape[1] = __pyx_v_positive_array.shape[2];
__pyx_t_23.strides[1] = __pyx_v_positive_array.strides[2];
    __pyx_t_23.suboffsets[1] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_23, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_transpose);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_7)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          }
        }
        if (__pyx_t_7) {
          __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        } else {
          __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_24);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_24);
        __pyx_t_24 = 0;
        __pyx_t_24 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmin, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_vmax, __pyx_t_7) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-80" onclick='toggleDiv(this)'>+<span class="">185</span>:                 ax3.imshow(np.asarray(positive_array[:,:,mid_z_array],dtype=np.double),vmin=MINVAL,vmax=MAXVAL)</pre>
<pre class='cython code score-80 '>        if (unlikely(!__pyx_v_ax3)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("ax3"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax3, __pyx_n_s_imshow);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_24 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_24, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
        __pyx_t_25.data = __pyx_v_positive_array.data;
        __pyx_t_25.memview = __pyx_v_positive_array.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_25, 0);
        __pyx_t_25.shape[0] = __pyx_v_positive_array.shape[0];
__pyx_t_25.strides[0] = __pyx_v_positive_array.strides[0];
    __pyx_t_25.suboffsets[0] = -1;

__pyx_t_25.shape[1] = __pyx_v_positive_array.shape[1];
__pyx_t_25.strides[1] = __pyx_v_positive_array.strides[1];
    __pyx_t_25.suboffsets[1] = -1;

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_mid_z_array;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_positive_array.shape[2];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_positive_array.strides[2];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 2)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_25.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_24 = __pyx_memoryview_fromslice(__pyx_t_25, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_25, 1);
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_24);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_24);
        __pyx_t_24 = 0;
        __pyx_t_24 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_24, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
        __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MINVAL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_vmin, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_MAXVAL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_vmax, __pyx_t_6) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_24, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">187</span>:                 plt.pause(1e-3)</pre>
<pre class='cython code score-14 '>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_pause);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_float_1eneg_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class="cython line score-0">&#xA0;<span class="">188</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>:         # calculate the new densities and store them in temporary arrays</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">190</span>:         for i in range(1,no_x-1):</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_v_no_x - 1);
    for (__pyx_t_15 = 1; __pyx_t_15 &lt; __pyx_t_2; __pyx_t_15+=1) {
      __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">191</span>:             for j in range(1,no_y-1):</pre>
<pre class='cython code score-0 '>      __pyx_t_16 = (__pyx_v_no_y - 1);
      for (__pyx_t_17 = 1; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_j = __pyx_t_17;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">192</span>:                 for k in range(1,no_z_with_buffer-1):</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_no_z_with_buffer - 1);
        for (__pyx_t_19 = 1; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
          __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-0">&#xA0;<span class="">193</span>:                     # using the Lax-Wendroff scheme</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">194</span>:                     positive_temp_entry = (sz+cz*(cz+1.)/2.)*positive_array[i,j,k-1]</pre>
<pre class='cython code score-0 '>          __pyx_t_27 = __pyx_v_i;
          __pyx_t_28 = __pyx_v_j;
          __pyx_t_29 = (__pyx_v_k - 1);
          __pyx_v_positive_temp_entry = ((__pyx_v_sz + ((__pyx_v_cz * (__pyx_v_cz + 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_27 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_28 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_29)) ))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">195</span>:                     positive_temp_entry += (sz+cz*(cz-1.)/2.)*positive_array[i,j,k+1]</pre>
<pre class='cython code score-0 '>          __pyx_t_30 = __pyx_v_i;
          __pyx_t_31 = __pyx_v_j;
          __pyx_t_32 = (__pyx_v_k + 1);
          __pyx_v_positive_temp_entry = (__pyx_v_positive_temp_entry + ((__pyx_v_sz + ((__pyx_v_cz * (__pyx_v_cz - 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_30 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_31 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_32)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">196</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">197</span>:                     positive_temp_entry += (sy+cy*(cy+1.)/2.)*positive_array[i,j-1,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_33 = __pyx_v_i;
          __pyx_t_34 = (__pyx_v_j - 1);
          __pyx_t_35 = __pyx_v_k;
          __pyx_v_positive_temp_entry = (__pyx_v_positive_temp_entry + ((__pyx_v_sy + ((__pyx_v_cy * (__pyx_v_cy + 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_33 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_34 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_35)) )))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">198</span>:                     positive_temp_entry += (sy+cy*(cy-1.)/2.)*positive_array[i,j+1,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_36 = __pyx_v_i;
          __pyx_t_37 = (__pyx_v_j + 1);
          __pyx_t_38 = __pyx_v_k;
          __pyx_v_positive_temp_entry = (__pyx_v_positive_temp_entry + ((__pyx_v_sy + ((__pyx_v_cy * (__pyx_v_cy - 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_36 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_37 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_38)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">199</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">200</span>:                     positive_temp_entry += (sx+cx*(cx+1.)/2.)*positive_array[i-1,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_39 = (__pyx_v_i - 1);
          __pyx_t_40 = __pyx_v_j;
          __pyx_t_41 = __pyx_v_k;
          __pyx_v_positive_temp_entry = (__pyx_v_positive_temp_entry + ((__pyx_v_sx + ((__pyx_v_cx * (__pyx_v_cx + 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_39 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_40 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_41)) )))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">201</span>:                     positive_temp_entry += (sx+cx*(cx-1.)/2.)*positive_array[i+1,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_42 = (__pyx_v_i + 1);
          __pyx_t_43 = __pyx_v_j;
          __pyx_t_44 = __pyx_v_k;
          __pyx_v_positive_temp_entry = (__pyx_v_positive_temp_entry + ((__pyx_v_sx + ((__pyx_v_cx * (__pyx_v_cx - 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_42 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_43 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_44)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">202</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">203</span>:                     positive_temp_entry += (1.- cx*cx - cy*cy - cz*cz - 2.*(sx+sy+sz))*positive_array[i,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_45 = __pyx_v_i;
          __pyx_t_46 = __pyx_v_j;
          __pyx_t_47 = __pyx_v_k;
          __pyx_v_positive_temp_entry = (__pyx_v_positive_temp_entry + (((((1. - (__pyx_v_cx * __pyx_v_cx)) - (__pyx_v_cy * __pyx_v_cy)) - (__pyx_v_cz * __pyx_v_cz)) - (2. * ((__pyx_v_sx + __pyx_v_sy) + __pyx_v_sz))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_45 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_46 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_47)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">205</span>:                     # same for the negative charge carriers</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">206</span>:                     negative_temp_entry = (sz+cz*(cz+1.)/2.)*negative_array[i,j,k+1]</pre>
<pre class='cython code score-0 '>          __pyx_t_48 = __pyx_v_i;
          __pyx_t_49 = __pyx_v_j;
          __pyx_t_50 = (__pyx_v_k + 1);
          __pyx_v_negative_temp_entry = ((__pyx_v_sz + ((__pyx_v_cz * (__pyx_v_cz + 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_48 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_49 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_50)) ))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">207</span>:                     negative_temp_entry += (sz+cz*(cz-1.)/2.)*negative_array[i,j,k-1]</pre>
<pre class='cython code score-0 '>          __pyx_t_51 = __pyx_v_i;
          __pyx_t_52 = __pyx_v_j;
          __pyx_t_53 = (__pyx_v_k - 1);
          __pyx_v_negative_temp_entry = (__pyx_v_negative_temp_entry + ((__pyx_v_sz + ((__pyx_v_cz * (__pyx_v_cz - 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_51 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_52 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_53)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">208</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">209</span>:                     negative_temp_entry += (sy+cy*(cy+1.)/2.)*negative_array[i,j+1,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_54 = __pyx_v_i;
          __pyx_t_55 = (__pyx_v_j + 1);
          __pyx_t_56 = __pyx_v_k;
          __pyx_v_negative_temp_entry = (__pyx_v_negative_temp_entry + ((__pyx_v_sy + ((__pyx_v_cy * (__pyx_v_cy + 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_54 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_55 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_56)) )))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">210</span>:                     negative_temp_entry += (sy+cy*(cy-1.)/2.)*negative_array[i,j-1,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_57 = __pyx_v_i;
          __pyx_t_58 = (__pyx_v_j - 1);
          __pyx_t_59 = __pyx_v_k;
          __pyx_v_negative_temp_entry = (__pyx_v_negative_temp_entry + ((__pyx_v_sy + ((__pyx_v_cy * (__pyx_v_cy - 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_57 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_58 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_59)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">211</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">212</span>:                     negative_temp_entry += (sx+cx*(cx+1.)/2.)*negative_array[i+1,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_60 = (__pyx_v_i + 1);
          __pyx_t_61 = __pyx_v_j;
          __pyx_t_62 = __pyx_v_k;
          __pyx_v_negative_temp_entry = (__pyx_v_negative_temp_entry + ((__pyx_v_sx + ((__pyx_v_cx * (__pyx_v_cx + 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_60 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_61 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_62)) )))));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">213</span>:                     negative_temp_entry += (sx+cx*(cx-1.)/2.)*negative_array[i-1,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_63 = (__pyx_v_i - 1);
          __pyx_t_64 = __pyx_v_j;
          __pyx_t_65 = __pyx_v_k;
          __pyx_v_negative_temp_entry = (__pyx_v_negative_temp_entry + ((__pyx_v_sx + ((__pyx_v_cx * (__pyx_v_cx - 1.)) / 2.)) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_63 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_64 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_65)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">214</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">215</span>:                     negative_temp_entry += (1. - cx*cx - cy*cy - cz*cz - 2.*(sx+sy+sz))*negative_array[i,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_66 = __pyx_v_i;
          __pyx_t_67 = __pyx_v_j;
          __pyx_t_68 = __pyx_v_k;
          __pyx_v_negative_temp_entry = (__pyx_v_negative_temp_entry + (((((1. - (__pyx_v_cx * __pyx_v_cx)) - (__pyx_v_cy * __pyx_v_cy)) - (__pyx_v_cz * __pyx_v_cz)) - (2. * ((__pyx_v_sx + __pyx_v_sy) + __pyx_v_sz))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_66 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_67 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_68)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:                     # the recombination part</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">218</span>:                     recomb_temp = alpha*positive_array[i,j,k]*negative_array[i,j,k]*dt</pre>
<pre class='cython code score-0 '>          __pyx_t_69 = __pyx_v_i;
          __pyx_t_70 = __pyx_v_j;
          __pyx_t_71 = __pyx_v_k;
          __pyx_t_72 = __pyx_v_i;
          __pyx_t_73 = __pyx_v_j;
          __pyx_t_74 = __pyx_v_k;
          __pyx_v_recomb_temp = (((__pyx_v_alpha * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_69 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_70 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_71)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_72 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_73 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_74)) )))) * __pyx_v_dt);
</pre><pre class="cython line score-0">&#xA0;<span class="">219</span>:                     # the total recombination</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">220</span>:                     no_recombined_charge_carriers += recomb_temp</pre>
<pre class='cython code score-0 '>          __pyx_v_no_recombined_charge_carriers = (__pyx_v_no_recombined_charge_carriers + __pyx_v_recomb_temp);
</pre><pre class="cython line score-0">&#xA0;<span class="">221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">222</span>:                     # positive array</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">223</span>:                     positive_array_temp[i,j,k] = positive_temp_entry - recomb_temp</pre>
<pre class='cython code score-0 '>          __pyx_t_75 = __pyx_v_i;
          __pyx_t_76 = __pyx_v_j;
          __pyx_t_77 = __pyx_v_k;
          *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array_temp.data + __pyx_t_75 * __pyx_v_positive_array_temp.strides[0]) ) + __pyx_t_76 * __pyx_v_positive_array_temp.strides[1]) )) + __pyx_t_77)) )) = (__pyx_v_positive_temp_entry - __pyx_v_recomb_temp);
</pre><pre class="cython line score-0">&#xA0;<span class="">224</span>:                     # negative array</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">225</span>:                     negative_array_temp[i,j,k] = negative_temp_entry - recomb_temp</pre>
<pre class='cython code score-0 '>          __pyx_t_78 = __pyx_v_i;
          __pyx_t_79 = __pyx_v_j;
          __pyx_t_80 = __pyx_v_k;
          *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array_temp.data + __pyx_t_78 * __pyx_v_negative_array_temp.strides[0]) ) + __pyx_t_79 * __pyx_v_negative_array_temp.strides[1]) )) + __pyx_t_80)) )) = (__pyx_v_negative_temp_entry - __pyx_v_recomb_temp);
        }
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>:         # update the positive and negative arrays</pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">228</span>:         for i in range(1,no_x-1):</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_v_no_x - 1);
    for (__pyx_t_15 = 1; __pyx_t_15 &lt; __pyx_t_2; __pyx_t_15+=1) {
      __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">229</span>:             for j in range(1,no_y-1):</pre>
<pre class='cython code score-0 '>      __pyx_t_16 = (__pyx_v_no_y - 1);
      for (__pyx_t_17 = 1; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_j = __pyx_t_17;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">230</span>:                 for k in range(1,no_z_with_buffer-1):</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_no_z_with_buffer - 1);
        for (__pyx_t_19 = 1; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
          __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">231</span>:                     positive_array[i,j,k] = positive_array_temp[i,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_81 = __pyx_v_i;
          __pyx_t_82 = __pyx_v_j;
          __pyx_t_83 = __pyx_v_k;
          __pyx_t_84 = __pyx_v_i;
          __pyx_t_85 = __pyx_v_j;
          __pyx_t_86 = __pyx_v_k;
          *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array.data + __pyx_t_84 * __pyx_v_positive_array.strides[0]) ) + __pyx_t_85 * __pyx_v_positive_array.strides[1]) )) + __pyx_t_86)) )) = (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_positive_array_temp.data + __pyx_t_81 * __pyx_v_positive_array_temp.strides[0]) ) + __pyx_t_82 * __pyx_v_positive_array_temp.strides[1]) )) + __pyx_t_83)) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">232</span>:                     negative_array[i,j,k] = negative_array_temp[i,j,k]</pre>
<pre class='cython code score-0 '>          __pyx_t_87 = __pyx_v_i;
          __pyx_t_88 = __pyx_v_j;
          __pyx_t_89 = __pyx_v_k;
          __pyx_t_90 = __pyx_v_i;
          __pyx_t_91 = __pyx_v_j;
          __pyx_t_92 = __pyx_v_k;
          *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array.data + __pyx_t_90 * __pyx_v_negative_array.strides[0]) ) + __pyx_t_91 * __pyx_v_negative_array.strides[1]) )) + __pyx_t_92)) )) = (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_negative_array_temp.data + __pyx_t_87 * __pyx_v_negative_array_temp.strides[0]) ) + __pyx_t_88 * __pyx_v_negative_array_temp.strides[1]) )) + __pyx_t_89)) )));
        }
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">233</span>: </pre>
<pre class="cython line score-18" onclick='toggleDiv(this)'>+<span class="">234</span>:     return [no_initialised_charge_carriers,no_recombined_charge_carriers]</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_no_initialised_charge_carriers);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_no_recombined_charge_carriers);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_24 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_24, 1, __pyx_t_5);
  __pyx_t_6 = 0;
  __pyx_t_5 = 0;
  __pyx_r = __pyx_t_24;
  __pyx_t_24 = 0;
  goto __pyx_L0;
</pre></div></body></html>
